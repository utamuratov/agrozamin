<nz-modal
  [(nzVisible)]="isVisible"
  nzTitle="{{ null }}"
  [nzContent]="modalContent"
  [nzFooter]="modalFooter"
  (nzOnCancel)="handleCancel()"
>
  <ng-template #modalContent>
    <div nz-row [nzGutter]="[0, 10]">
      <div
        nz-col
        nzXs="24"
        nzSm="24"
        nzMd="24"
        nzLg="24"
        nzXl="24"
        nzXXl="24"
        class="text-center"
      >
        <div nz-row class="mt-1">
          <input
            #photo
            [hidden]="true"
            type="file"
            (change)="fileChangeEvent($event)"
          />
          <div
            nz-col
            nzXs="0"
            nzSm="24"
            nzMd="24"
            nzLg="24"
            nzXl="24"
            nzXXl="24"
          >
            <image-cropper
              *ngIf="imageChangedEvent"
              [imageChangedEvent]="imageChangedEvent"
              [maintainAspectRatio]="true"
              [aspectRatio]="1 / 1"
              [transform]="{ scale: zoom, rotate: rotate }"
              format="png"
              (imageCropped)="imageCropped($event)"
              (imageLoaded)="imageLoaded($event)"
              (cropperReady)="cropperReady()"
              (loadImageFailed)="loadImageFailed()"
            ></image-cropper>

            <!-- <img [src]="croppedImage" /> -->
            <nz-avatar
              *ngIf="!imageChangedEvent"
              [nzShape]="'square'"
              [nzSize]="300"
              [nzIcon]="'user'"
            ></nz-avatar>
          </div>
          <div nz-col nzXs="24" nzSm="0" nzMd="0" nzLg="0" nzXl="0" nzXXl="0">
            <image-cropper
              *ngIf="imageChangedEvent"
              [imageChangedEvent]="imageChangedEvent"
              [maintainAspectRatio]="true"
              [aspectRatio]="1 / 1"
              format="png"
              (imageCropped)="imageCropped($event)"
              (imageLoaded)="imageLoaded($event)"
              (cropperReady)="cropperReady()"
              (loadImageFailed)="loadImageFailed()"
            ></image-cropper>
            <nz-avatar
              *ngIf="!imageChangedEvent"
              [nzShape]="'square'"
              [nzSize]="180"
              [nzIcon]="'user'"
            ></nz-avatar>
          </div>
        </div>
      </div>
      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" nzXXl="24">
        <p nz-typography>
          Отредактируйте свою фотографию, переместив круг или изменив его
          размер. Можно использовать мышь или клавиши со стрелками, а также
          клавиши "плюс" и "минус" на клавиатуре.
        </p>
      </div>
      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" nzXXl="24">
        <div nz-row [nzGutter]="[10, 10]">
          <div nz-col nzXs="24" nzSm="12">
            <div nz-row nzAlign="middle">
              <div
                nz-col
                nzXs="2"
                nzSm="2"
                nzMd="2"
                nzLg="2"
                nzXl="2"
                nzXXl="2"
              >
                <i nz-icon nzType="zoom-in" nzTheme="outline"></i>
              </div>
              <div
                nz-col
                nzXs="20"
                nzSm="20"
                nzMd="20"
                nzLg="20"
                nzXl="20"
                nzXXl="20"
              >
                <nz-slider
                  [(ngModel)]="zoom"
                  [nzDisabled]="disabled"
                  [nzMax]="10"
                ></nz-slider>
              </div>
              <div
                nz-col
                nzXs="2"
                nzSm="2"
                nzMd="2"
                nzLg="2"
                nzXl="2"
                nzXXl="2"
              >
                <span>{{ zoom }}</span>
              </div>
            </div>
          </div>
          <div nz-col nzXs="24" nzSm="12">
            <div nz-row nzAlign="middle">
              <div
                nz-col
                nzXs="2"
                nzSm="2"
                nzMd="2"
                nzLg="2"
                nzXl="2"
                nzXXl="2"
              >
                <i nz-icon nzType="reload" nzTheme="outline"></i>
              </div>
              <div
                nz-col
                nzXs="20"
                nzSm="20"
                nzMd="20"
                nzLg="20"
                nzXl="20"
                nzXXl="20"
              >
                <nz-slider
                  [(ngModel)]="rotate"
                  [nzDisabled]="disabled"
                  [nzMin]="-5"
                  [nzMax]="5"
                ></nz-slider>
              </div>
              <div
                nz-col
                nzXs="2"
                nzSm="2"
                nzMd="2"
                nzLg="2"
                nzXl="2"
                nzXXl="2"
              >
                <span>{{ rotate }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" nzXXl="24">
        <button
          nz-button
          nzType="link"
          class="font-agro-medium"
          (click)="photo.click()"
        >
          <i nz-icon nzType="upload"></i>
          Добавить фотографию
        </button>
      </div>
      <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" nzXXl="24">
        <button nz-button nzType="link" nzDanger class="font-agro-medium">
          <i nz-icon nzType="delete" nzTheme="outline"></i>
          Удалить фотографию
        </button>
      </div>
    </div>
  </ng-template>

  <ng-template #modalFooter>
    <div nz-row [nzGutter]="[20, 10]">
      <div nz-col nzSpan="12">
        <button
          nzBlock
          nz-button
          nzType="default"
          (click)="handleCancel()"
          nzShape="round"
        >
          Далее
        </button>
      </div>
      <div nz-col nzSpan="12">
        <button
          nzBlock
          nz-button
          nzType="primary"
          (click)="handleOk()"
          [nzLoading]="isConfirmLoading"
          nzShape="round"
        >
          Сохранить
        </button>
      </div>
    </div>
  </ng-template>
</nz-modal>
