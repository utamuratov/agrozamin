<div nz-row>
  <div nz-col nzXs="0" nzSm="24">
    <nz-card
      class="business-widget"
      nzHoverable
      [nzTitle]="companyCardTitle"
      [nzExtra]="companyCard"
    >
      <div nz-row [nzGutter]="[0, 10]">
        <div
          *ngFor="let company of companies"
          nz-col
          class="business-widget__card"
          nzSpan="24"
        >
          <div nz-row [nzGutter]="[10, 10]" nzAlign="middle">
            <div nz-col nzSpan="4" class="business-widget__card__img">
              <!-- <img [src]="company.avatar ? company.avatar : ''" alt="avatar"> -->
              <nz-avatar
                nzSize="small"
                [nzIcon]="company.avatar ? '' : 'user'"
                [nzSrc]="company.avatar ? company.avatar : ''"
              ></nz-avatar>
            </div>
            <div nz-col nzSpan="16" class="business-widget__card__desc">
              <h6 nz-typography>{{ company.name }}</h6>
              <p nz-typography>{{ company.stir }}</p>
              <p nz-typography>{{ company.city }}</p>
            </div>
            <div nz-col nzSpan="4">
              <div nz-row>
                <div nz-col>
                  <button
                    nz-button
                    nzType="text"
                    nzShape="circle"
                    nz-popover
                    nzPopoverTitle="{{ null }}"
                    nzPopoverPlacement="bottomLeft"
                    [(nzPopoverVisible)]="company.visibleDesktop"
                    (nzPopoverVisibleChange)="change($event, company)"
                    nzPopoverTrigger="click"
                    [nzPopoverContent]="contentTemplate"
                  >
                    <i nz-icon nzType="more" nzTheme="outline"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div nz-row>
            <div nz-col nzXs="0" nzSm="24">
              <ng-template #contentTemplate>
                <div style="width: 132px">
                  <button
                    nz-button
                    nzBlock
                    nzType="link"
                    class="text-start"
                    (click)="modal.isVisible = true"
                  >
                    <i nz-icon nzType="edit" nzTheme="outline"></i>Изменить
                  </button>
                  <button
                    nz-button
                    nzBlock
                    nzType="link"
                    nzDanger
                    class="text-start"
                    (click)="deleteCard(company.id)"
                  >
                    <i nz-icon nzType="delete" nzTheme="outline"></i>Удалить
                  </button>
                </div>
              </ng-template>
            </div>
          </div>
        </div>
        <div nz-col class="business-widget__btn" nzSpan="24">
          <button nz-button nzBlock (click)="modal.isVisible = true">
            <i nz-icon nzType="plus" nzTheme="outline"></i>
          </button>
        </div>
      </div>
    </nz-card>
    <ng-template #companyCardTitle>
      <span class="home__card_title">Мои организации</span>
    </ng-template>
    <ng-template #companyCard>
      <a
        ><i
          nz-icon
          nzType="arrow-right"
          nzTheme="outline"
          style="color: #cfd3d8"
        ></i
      ></a>
    </ng-template>
  </div>
  <div nz-col nzXs="24" nzSm="0">
    <nz-collapse nzExpandIconPosition="right" class="widget-collpase">
      <nz-collapse-panel
        [nzHeader]="title3"
        class="collpase-bg"
        style="border-radius: 5px"
      >
        <div nz-row [nzGutter]="[0, 10]">
          <div
            nz-col
            *ngFor="let company of companies"
            class="business-widget__card"
            nzSpan="24"
          >
            <div nz-row [nzGutter]="[10, 10]">
              <div nz-col nzSpan="4" class="business-widget__card__img">
                <nz-avatar
                  nzSize="small"
                  [nzIcon]="company.avatar ? '' : 'user'"
                  [nzSrc]="company.avatar ? company.avatar : ''"
                ></nz-avatar>
              </div>
              <div nz-col nzSpan="16" class="business-widget__card__desc">
                <h6 nz-typography>{{ company.name }}</h6>
                <p nz-typography>{{ company.stir }}</p>
                <p nz-typography>{{ company.city }}</p>
              </div>
              <div nz-col nzSpan="4">
                <div nz-row>
                  <div nz-col>
                    <button
                      nz-button
                      nzType="text"
                      nzShape="circle"
                      nz-popover
                      nzPopoverTitle="{{ null }}"
                      nzPopoverPlacement="bottomLeft"
                      [(nzPopoverVisible)]="company.visibleMobile"
                      (nzPopoverVisibleChange)="change($event, company)"
                      nzPopoverTrigger="click"
                      [nzPopoverContent]="contentTemplateColapse"
                    >
                      <i nz-icon nzType="more" nzTheme="outline"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <ng-template #contentTemplateColapse>
              <div style="width: 132px">
                <button
                  nz-button
                  nzBlock
                  nzType="link"
                  class="text-start"
                  (click)="modal.isVisible = true"
                >
                  <i nz-icon nzType="edit" nzTheme="outline"></i>Изменить
                </button>
                <button
                  nz-button
                  nzBlock
                  nzType="link"
                  nzDanger
                  class="text-start"
                  (click)="deleteCard(company.id)"
                >
                  <i nz-icon nzType="delete" nzTheme="outline"></i>Удалить
                </button>
              </div>
            </ng-template>
          </div>
          <div nz-col class="business-widget__btn" nzSpan="24">
            <button (click)="modal.isVisible = true" nz-button nzBlock>
              <i nz-icon nzType="plus" nzTheme="outline"></i>
            </button>
          </div>
        </div>
      </nz-collapse-panel>
    </nz-collapse>

    <ng-template #title3>
      <div nz-row>
        <div nz-col>
          <i nz-icon nzType="audit" nzTheme="outline"></i>
        </div>
        <div nz-col>
          <span class="home__card_title">Мои организации</span>
        </div>
      </div>
    </ng-template>
  </div>
</div>

<az-company-modal #modal></az-company-modal>
