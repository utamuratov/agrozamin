<div nz-row [nzGutter]="[0, 20]">
  <!-- Sort Bar -->
  <div nz-col nzSpan="24">
    <div class="sort">
      <div
        nz-row
        nzAlign="middle"
        nzJustify="space-between"
        [nzGutter]="[0, { xs: 10, sm: 10, md: 10, lg: 0, xl: 0 }]"
      >
        <div nz-col class="sort__left">
          <az-sort
            (sortedByPriceDescandingChange)="sortByPriceDescanding($event)"
            (sortedByDateDescandingChange)="sortByDateDescanding($event)"
          ></az-sort>
        </div>
        <div nz-col class="sort__right selects">
          <div
            nz-row
            [nzGutter]="[20, { xs: 10, sm: 10, md: 0, lg: 0, xl: 0 }]"
          >
            <div nz-col class="selects">
              <nz-select
                nzShowSearch
                nzAllowClear
                nzPlaceHolder="Все категории"
                nzSize="large"
                [(ngModel)]="categoryId"
                (ngModelChange)="onChangeCategoryFilter()"
                class="select-category"
              >
                <nz-option
                  [nzValue]="category.id"
                  [nzLabel]="category.name"
                  *ngFor="let category of categories"
                ></nz-option>
              </nz-select>
            </div>
            <div nz-col class="selects">
              <nz-select
                nzShowSearch
                nzAllowClear
                nzPlaceHolder="Все типы объявлений"
                nzSize="large"
                [(ngModel)]="advertisementTypeId"
                (ngModelChange)="onChangeAdvertisementTypeFilter()"
                [nzDropdownMatchSelectWidth]="false"
                class="select-type"
              >
                <nz-option
                  [nzValue]="advertisementType.id"
                  [nzLabel]="advertisementType.name"
                  *ngFor="let advertisementType of advertisementTypes"
                ></nz-option>
              </nz-select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-container *ngIf="data.total; else empty">
    <div nz-col nzSpan="24" *ngFor="let advertisement of data.data">
      <div class="advert__card">
        <div nz-row>
          <!-- IMAGE -->
          <div nz-col nzXs="8" nzSm="7" nzMd="7" nzLg="6" nzXl="6" nzXXl="6">
            <div class="advert__card__left">
              <div class="advert__card__left__img">
                <img [src]="advertisement?.file | noImage" alt="card image" />
              </div>
              <div class="advert__card__left__options">
                <div nz-row nzJustify="space-between">
                  <div nz-col>
                    <az-tag
                      [title]="advertisement.category.name"
                      [category_id]="advertisement.category_id"
                    ></az-tag>
                  </div>
                  <div nz-col>
                    <button
                      class="advert__card__left__options__favourite"
                      (click)="toggleFavourite(advertisement)"
                    >
                      <svg
                        width="21"
                        height="18"
                        viewBox="0 0 21 18"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M2.28651 10.4336L2.28901 10.436L9.2866 16.9637C9.40016 17.0725 9.51083 17.1781 9.61582 17.2581C9.7306 17.3455 9.86744 17.4257 10.042 17.4606L10.0906 17.4703H10.1401H10.3301C10.5793 17.4703 10.7589 17.3411 10.8602 17.2577C10.933 17.1979 11.0185 17.1145 11.0986 17.0365C11.1246 17.0111 11.15 16.9863 11.1743 16.963C11.1749 16.9625 11.1754 16.9619 11.176 16.9613L18.1213 10.4358C18.1214 10.4357 18.1216 10.4356 18.1217 10.4355C19.1626 9.46319 19.8018 8.13639 19.9134 6.71634C20.025 5.29638 19.6009 3.88612 18.7247 2.76322C18.7245 2.76304 18.7244 2.76287 18.7242 2.76269L18.4153 2.36412C17.9121 1.71455 17.2508 1.20475 16.4946 0.883313C15.7384 0.56188 14.9124 0.439512 14.0955 0.52792C13.2785 0.616328 12.4979 0.912551 11.8279 1.38832C11.158 1.8641 10.6211 2.50359 10.2685 3.24577L10.2624 3.25848L10.2571 3.2715C10.2541 3.2788 10.249 3.2851 10.2424 3.28957C10.2357 3.29402 10.228 3.29638 10.2201 3.29638C10.2122 3.29638 10.2044 3.29402 10.1978 3.28957C10.1911 3.2851 10.186 3.2788 10.183 3.2715L10.1777 3.25848L10.1717 3.24577C9.81905 2.5036 9.28216 1.8641 8.61221 1.38832C7.94227 0.912551 7.1616 0.616328 6.34467 0.52792C5.52773 0.439512 4.70178 0.56188 3.94556 0.883313C3.18936 1.20474 2.52812 1.71453 2.02488 2.36406C2.02486 2.36408 2.02485 2.3641 2.02483 2.36412L1.71572 2.76296C0.83828 3.8826 0.410314 5.28945 0.515698 6.70809C0.621118 8.1272 1.25264 9.45581 2.28651 10.4336Z"
                          [ngStyle]="{
                            fill: advertisement.favorite ? 'white' : '#00CD69',
                            stroke: advertisement.favorite ? '#B7BBBF' : 'white'
                          }"
                          fill="white"
                          fill-opacity="0.75"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- DESCRIPTION -->
          <div
            nz-col
            nzXs="11"
            nzSm="13"
            nzMd="11"
            nzLg="12"
            nzXl="11"
            nzXXl="11"
          >
            <div class="advert__card__middle">
              <div
                nz-row
                class="advert__card__middle-row"
                [nzGutter]="[0, { xs: 10, sm: 0 }]"
              >
                <div
                  nz-col
                  nzXs="24"
                  nzSm="0"
                  nzMd="0"
                  nzLg="0"
                  nzXl="0"
                  nzXXl="0"
                >
                  <az-tag [title]="'Category'" [category_id]="1"></az-tag>
                </div>
                <div
                  nz-col
                  nzXs="24"
                  nzSm="24"
                  nzMd="24"
                  nzLg="24"
                  nzXl="24"
                  nzXXl="24"
                >
                  <h4
                    class="advert__card__middle__title"
                    nz-typography
                    nzEllipsis
                    nzEllipsisRows="2"
                  >
                    {{ advertisement.name }}
                  </h4>
                </div>
                <div
                  nz-col
                  nzXs="0"
                  nzSm="0"
                  nzMd="0"
                  nzLg="24"
                  nzXl="24"
                  nzXXl="24"
                >
                  <p
                    class="advert__card__middle__description"
                    nz-typography
                    nzEllipsis
                    nzEllipsisRows="4"
                  >
                    {{ advertisement.description }}
                  </p>
                </div>
                <div
                  nz-col
                  nzXs="24"
                  nzSm="24"
                  nzMd="24"
                  nzLg="24"
                  nzXl="24"
                  nzXXl="24"
                  class="advert__card__middle-col"
                >
                  <span class="advert__card__middle__price">{{
                    advertisement.price | azCurrency
                  }}</span>
                </div>
                <div
                  nz-col
                  nzXs="24"
                  nzSm="24"
                  nzMd="24"
                  nzLg="0"
                  nzXl="0"
                  nzXXl="0"
                >
                  <div class="advert__card__middle__seller">
                    <div
                      nz-row
                      [nzGutter]="[
                        0,
                        { xs: 4, sm: 10, md: 10, lg: 10, xl: 10 }
                      ]"
                    >
                      <div nz-col nzSpan="24">
                        <div
                          nz-row
                          [nzGutter]="[{ xs: 6, sm: 6, md: 12 }, 0]"
                          nzAlign="middle"
                        >
                          <div nz-col nzXs="4" nzSm="2" nzMd="2" nzLg="0">
                            <i
                              nz-icon
                              class="advert__card__middle__seller__icon"
                            >
                              <img src="/assets/images/house.png" alt="icon" />
                            </i>
                          </div>
                          <div nz-col nzXs="20" nzSm="22" nzMd="22" nzLg="0">
                            <a class="advert__card__middle__seller__text"
                              >Жахонгир Пардаев</a
                            >
                          </div>
                        </div>
                      </div>
                      <div nz-col nzSpan="24">
                        <div
                          nz-row
                          [nzGutter]="[{ xs: 6, sm: 6, md: 12 }, 0]"
                          nzAlign="middle"
                        >
                          <div nz-col nzXs="4" nzSm="2" nzMd="2" nzLg="0">
                            <i
                              nz-icon
                              class="advert__card__middle__seller__icon"
                            >
                              <img
                                src="/assets/images/location.svg"
                                alt="icon"
                              />
                            </i>
                          </div>
                          <div nz-col nzXs="20" nzSm="22" nzMd="22" nzLg="0">
                            <span class="advert__card__middle__seller__loc">
                              Ташкентская область, г.Ташкент
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  nz-col
                  nzXs="24"
                  nzSm="0"
                  nzMd="0"
                  nzLg="0"
                  nzXl="0"
                  nzXXl="0"
                >
                  <div nz-row [nzGutter]="[10, 0]">
                    <div nz-col>
                      <i nz-icon nzType="eye" nzTheme="outline"></i>
                      <span class="statistic-text">{{
                        advertisement.views_count
                      }}</span>
                    </div>
                    <div nz-col>
                      <i nz-icon nzType="heart" nzTheme="outline"></i>
                      <span class="statistic-text">{{
                        advertisement.favorite_count
                      }}</span>
                    </div>
                    <div nz-col>
                      <i nz-icon nzType="phone" nzTheme="outline"></i>
                      <span class="statistic-text">{{
                        advertisement.views_count_of_phone
                      }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- STATISTICS -->
          <div nz-col nzXs="5" nzSm="4" nzMd="6" nzLg="6" nzXl="7" nzXXl="7">
            <div class="advert__card__right">
              <div nz-row class="row right" [nzGutter]="[0, { xs: 8, sm: 0 }]">
                <div [ngSwitch]="status">
                  <!-- Moderated -->
                  <ng-container *ngSwitchCase="AdvertisementStatus.STATUS_NEW">
                    <div nz-col nzSpan="24">
                      <div
                        nz-row
                        [nzGutter]="[8, 0]"
                        nzAlign="middle"
                        nzJustify="end"
                      >
                        <div
                          nz-col
                          nzXs="24"
                          nzSm="24"
                          nzMd="4"
                          nzLg="4"
                          nzXl="4"
                        >
                          <img
                            nz-tooltip
                            nzTooltipTitle="На модерации"
                            src="./assets/images/view-outline.svg"
                            alt="icon"
                          />
                        </div>
                        <div
                          class="advert__card__right__moderated__text"
                          nz-col
                          nzXs="0"
                          nzSm="0"
                          nzMd="20"
                          nzLg="20"
                          nzXl="20"
                        >
                          <span>Объявление на модерации</span>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                  <!-- Active -->
                  <ng-container
                    *ngSwitchCase="AdvertisementStatus.STATUS_CONFIRMED"
                  >
                    <div
                      nz-col
                      nzXs="24"
                      nzSm="0"
                      nzMd="0"
                      nzLg="0"
                      nzXl="0"
                      nzXXl="0"
                      class="text-end"
                    >
                      <button
                        nz-button
                        [nzType]="favourite ? 'primary' : 'default'"
                        (click)="favourite = !favourite"
                        class="favourite-btn"
                      >
                        <i
                          nz-icon
                          nzType="heart"
                          [nzTheme]="favourite ? 'fill' : 'outline'"
                        ></i>
                      </button>
                    </div>
                    <div
                      nz-col
                      nzXs="0"
                      nzSm="24"
                      nzMd="24"
                      nzLg="24"
                      nzXl="24"
                      nzXXl="24"
                    >
                      <div class="advert__card__right__statistics">
                        <div nz-row [nzGutter]="[0, { xs: 0, sm: 8, md: 12 }]">
                          <div nz-col nzSpan="24">
                            <i nz-icon nzType="eye" nzTheme="outline"></i>
                            <span class="advert__card__right__statistics-text"
                              >{{ advertisement.views_count }}
                              <span
                                class="advert__card__right__statistics-text_mod"
                                >{{ "seen" | translate }}</span
                              ></span
                            >
                          </div>
                          <div nz-col nzSpan="24">
                            <i nz-icon nzType="heart" nzTheme="outline"></i>
                            <span class="advert__card__right__statistics-text"
                              >{{ advertisement.favorite_count }}
                              <span
                                class="advert__card__right__statistics-text_mod"
                                >{{ "addedToFavorite" | translate }}</span
                              ></span
                            >
                          </div>
                          <div nz-col nzSpan="24">
                            <i nz-icon nzType="phone" nzTheme="outline"></i>
                            <span class="advert__card__right__statistics-text"
                              >{{ advertisement.views_count_of_phone }}
                              <span
                                class="advert__card__right__statistics-text_mod"
                                >{{ "clickedCallButton" | translate }}</span
                              ></span
                            >
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                  <!-- Archived -->
                  <ng-container
                    *ngSwitchCase="AdvertisementStatus.STATUS_ARCHIVED"
                  >
                    <div nz-col nzSpan="24">
                      <div nz-row [nzGutter]="[8, 0]" nzAlign="middle">
                        <div
                          nz-col
                          nzXs="24"
                          nzSm="24"
                          nzMd="4"
                          nzLg="4"
                          nzXl="4"
                        >
                          <img
                            nz-tooltip
                            nzTooltipTitle="В архиве с 10.02.2022"
                            src="./assets/images/archive-dark.png"
                            alt=""
                          />
                        </div>
                        <div
                          class="advert-cards__rightContent__text"
                          nz-col
                          nzXs="0"
                          nzSm="0"
                          nzMd="20"
                          nzLg="20"
                          nzXl="20"
                        >
                          <span class="advert__card__right__moderated__text"
                            >В архиве с 10.02.2022</span
                          >
                        </div>
                      </div>
                    </div>
                  </ng-container>

                  <!-- Rejected -->
                  <ng-container
                    *ngSwitchCase="AdvertisementStatus.STATUS_REJECTED"
                  >
                    <div nz-col nzSpan="24">
                      <div nz-row [nzGutter]="[8, 0]">
                        <div
                          nz-col
                          nzXs="0"
                          nzSm="0"
                          nzMd="4"
                          nzLg="4"
                          nzXl="4"
                        >
                          <img
                            nz-tooltip
                            [nzTooltipTitle]="advertisement.reject_reason"
                            src="./assets/images/block-red.svg"
                            alt=""
                          />
                        </div>
                        <div
                          class="advert__card__right__moderated__text"
                          nz-col
                          nzXs="0"
                          nzSm="0"
                          nzMd="20"
                          nzLg="20"
                          nzXl="20"
                        >
                          <span>{{ "advertisementRejected" | translate }}</span>
                        </div>
                      </div>
                    </div>
                    <div
                      nz-col
                      nzXs="0"
                      nzSm="0"
                      nzMd="24"
                      nzLg="24"
                      nzXl="24"
                      class="advert-cards__content__description"
                    >
                      <p class="advert__card__right__moderated__text">
                        {{ advertisement.reject_reason }}
                      </p>
                    </div>
                  </ng-container>

                  <div *ngSwitchDefault></div>
                </div>

                <div
                  nz-col
                  nzXs="0"
                  nzSm="0"
                  nzMd="24"
                  nzLg="24"
                  nzXl="24"
                  nzXXl="24"
                  class="col"
                >
                  <div nz-row [nzGutter]="[10, 0]" nzAlign="bottom" class="row">
                    <!-- info -->
                    <div
                      nz-col
                      *ngIf="status === AdvertisementStatus.STATUS_REJECTED"
                    >
                      <button nz-button nzType="default">
                        <i nz-icon nzType="info-circle" nzTheme="outline"></i>
                      </button>
                    </div>

                    <div nz-col>
                      <button
                        nz-button
                        nzType="default"
                        (click)="navigateToDetails(advertisement)"
                      >
                        <i nz-icon nzType="eye" nzTheme="outline"></i>
                      </button>
                    </div>
                    <div nz-col>
                      <button
                        nz-button
                        nzType="default"
                        [routerLink]="[
                          '../../../advertisement',
                          'edit',
                          advertisement.id
                        ]"
                      >
                        <i nz-icon nzType="edit" nzTheme="outline"></i>
                      </button>
                    </div>
                    <div
                      nz-col
                      *ngIf="status === AdvertisementStatus.STATUS_CONFIRMED"
                    >
                      <button
                        nz-button
                        nzType="default"
                        (click)="addArchive(advertisement.id)"
                      >
                        <i nz-icon nzType="inbox" nzTheme="outline"></i>
                      </button>
                    </div>

                    <div
                      nz-col
                      *ngIf="status === AdvertisementStatus.STATUS_ARCHIVED"
                    >
                      <button
                        nz-button
                        nzType="default"
                        (click)="unArchive(advertisement.id)"
                      >
                        <i nz-icon nzType="poweroff" nzTheme="outline"></i>
                      </button>
                    </div>

                    <div
                      nz-col
                      *ngIf="
                        status === AdvertisementStatus.STATUS_ARCHIVED ||
                        status === AdvertisementStatus.STATUS_REJECTED
                      "
                    >
                      <button nz-button nzType="default">
                        <i nz-icon nzType="delete" nzTheme="outline"></i>
                      </button>
                    </div>
                  </div>
                </div>

                <div
                  nz-col
                  nzXs="24"
                  nzSm="24"
                  nzMd="0"
                  nzLg="0"
                  nzXl="0"
                  nzXXl="0"
                  class="more-btn"
                >
                  <button
                    nz-button
                    nzType="default"
                    nz-popover
                    [nzPopoverContent]="contentTemplate"
                    nzPopoverPlacement="bottomRight"
                    nzPopoverTrigger="click"
                  >
                    <i nz-icon nzType="ellipsis" nzTheme="outline"></i>
                  </button>
                </div>

                <!-- Popover -->
                <ng-template #contentTemplate>
                  <div class="popover">
                    <div nz-row [nzGutter]="[0, 5]">
                      <div
                        nz-col
                        nzSpan="24"
                        class="popover__content"
                        *ngIf="status === AdvertisementStatus.STATUS_REJECTED"
                      >
                        <div class="popover__content__item">
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i
                                nz-icon
                                nzType="info-circle"
                                nzTheme="outline"
                              ></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Информация</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div nz-col nzSpan="24" class="popover__content">
                        <div
                          class="popover__content__item"
                          (click)="navigateToDetails(advertisement)"
                        >
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i nz-icon nzType="eye" nzTheme="outline"></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Смотреть</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div nz-col nzSpan="24" class="popover__content">
                        <div
                          class="popover__content__item"
                          [routerLink]="[
                            '../../../advertisement',
                            'edit',
                            advertisement.id
                          ]"
                        >
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i nz-icon nzType="edit" nzTheme="outline"></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Редактировать</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div
                        nz-col
                        nzSpan="24"
                        class="popover__content"
                        *ngIf="
                          status === AdvertisementStatus.STATUS_ARCHIVED ||
                          status === AdvertisementStatus.STATUS_REJECTED
                        "
                      >
                        <div class="popover__content__item">
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i nz-icon nzType="delete" nzTheme="outline"></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Удалить</p>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div
                        nz-col
                        nzSpan="24"
                        class="popover__content"
                        *ngIf="status === AdvertisementStatus.STATUS_CONFIRMED"
                      >
                        <div
                          class="popover__content__item"
                          (click)="addArchive(advertisement.id)"
                        >
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i nz-icon nzType="inbox" nzTheme="outline"></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Архивировать</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        nz-col
                        nzSpan="24"
                        class="popover__content"
                        *ngIf="status === AdvertisementStatus.STATUS_ARCHIVED"
                      >
                        <div
                          class="popover__content__item"
                          (click)="unArchive(advertisement.id)"
                        >
                          <div nz-row>
                            <div nz-col nzSpan="4">
                              <i
                                nz-icon
                                nzType="poweroff"
                                nzTheme="outline"
                              ></i>
                            </div>
                            <div nz-col nzSpan="20">
                              <p>Разархивировать</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <ng-template #empty>
    <div nz-col nzSpan="24">
      <az-empty></az-empty>
    </div>
  </ng-template>

  <!-- Pagination -->
  <div nz-col nzSpan="24">
    <az-pagination
      [pageSize]="pageSize"
      [total]="data.total"
      [pageIndex]="query.pageIndex"
      (pageIndexChange)="paginate($event)"
    ></az-pagination>
  </div>
</div>
